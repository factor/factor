low-level message reading and writing
